<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>لوحة الموظف - نظام الدور</title>
  <link rel="stylesheet" href="./styles.css?v=23"/>
</head>
<body>
  <div class="container">
    <div class="top">
      <h1 id="instName">لوحة الموظف</h1>
      <p>إدخال رقم المتدرب ثم اختيار (رجال/نساء) ثم نداء</p>
    </div>

    <div class="subbar">
      <button class="btn mini" id="fsBtn" title="ملء الشاشة">⛶ ملء الشاشة</button>
      <div class="pill">الحالة: <b id="conn">غير متصل…</b></div>
      <div class="pill"></div>
    </div>

    <div class="cardRow">
      <div class="card">
        <div class="hd">الفرع</div>
        <div class="bd">
          <label>الفرع</label>
          <select id="branchSelect">
            <option value="SOHAR">1- Sohar</option>
<option value="MUSCAT">2- Muscat</option>
<option value="NIZWA">3- Nizwa</option>
<option value="IBRI">4- Ibri</option>
<option value="IBRA">5- Ibra</option>
<option value="SUR">6- Sur</option>
<option value="HAIMA">7- Haima</option>
<option value="SALALAH">8- Salalah</option>
<option value="BURAIMI">9- Buraimi</option>
<option value="MUSANDAM">10- Musandam</option>
<option value="RUSTAQ">11- Rustaq</option>
          </select>
          <input id="branchValue" type="hidden" />
          <label style="margin-top:10px">رقم التلميذ للنتيجة (اختياري)</label>
          <input id="resultNum" inputmode="numeric" placeholder="إذا تركته فاضي يستخدم الرقم الحالي"/>
          <div class="btns"><button class="gray" id="setBranch">تغيير الفرع</button></div>
          <small class="help">استخدم نفس الفرع في شاشة العرض والمدير.</small>

          <hr style="border:0;border-top:1px solid rgba(0,0,0,.12);margin:12px 0">

          <label>اسم المستخدم</label>
          <select id="username"><option value="">اختر المستخدم…</option></select>

          <label style="margin-top:10px">رقم الموظف</label>
          <input id="userPin" type="password" placeholder="أدخل الرقم"/>
        </div>
      </div>

      <div class="card">
        <div class="hd">النداء</div>
        <div class="bd">
          <div class="pill" id="msg">جاهز</div>
          <label style="margin-top:10px">نطاقي (اختياري)</label>
          <input id="staffRangeOverride" inputmode="numeric" placeholder="مثال: 10-30"/>
          <small class="help">إذا تركته فاضي، يتم استخدام نطاق المدير.</small>
          <label style="margin-top:10px">رقم المتدرب</label>
          <input id="ticketNum" inputmode="numeric" placeholder="مثال: 9"/>
          <label style="margin-top:10px">النوع</label>
          <select id="gender">
            <option value="">اختر…</option>
            <option value="men">رجال</option>
            <option value="women">نساء</option>
          </select>
          <div class="btns"><button class="primary" id="callNext">نداء</button>
          <button class="btn" id="requestNext">طلب التالي</button>
          <button class="btn success" id="passBtn">ناجح</button>
          <button class="btn danger" id="failBtn">راسب</button></div>
          <small class="help" style="margin-top:10px">الملاحظة من صلاحيات المدير فقط ✅</small>
        </div>
      </div>

      <div class="card">
        <div class="hd">آخر رقم (للتأكد)</div>
        <div class="bd" style="text-align:center">
          <div class="bigNumberCard"><p class="bigNumber" id="currentNum">--</p></div>
          <small class="help">شاشة العرض هي الشاشة الرسمية.</small>
        </div>
      </div>
    </div>

<div class="cardRow" style="margin-top:14px">
  <div class="card" style="grid-column:1/-1">
    <div class="hd">دردشة مع المدير (للفرع الحالي)</div>
    <div class="bd">
      <div id="chatListStaff" class="chatList"></div>
      <label style="margin-top:10px">اكتب رسالة</label>
      <input id="chatTextStaff" placeholder="رسالة للمدير..." />
      <div class="btns">
        <button class="primary" id="sendChatStaff">إرسال</button>
            <button class="danger" id="clearChatStaff">حذف الدردشة</button>
      </div>
      <small class="help">لن تُرسل الرسالة إلا بعد اختيار المستخدم وإدخال رقم الموظف ✅</small>
    </div>
  </div>
</div>

    <div class="rights">جميع الحقوق محفوظة — الرقيب أول يحيى آل عبدالسلام</div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/gun/gun.js"></script>
  <script src="./app.js?v=23"></script>
  <script>window.TQ.initStaff();</script>

<script>
  function toggleFullscreen(){
    try{
      if(!document.fullscreenElement){
        (document.documentElement.requestFullscreen||document.documentElement.webkitRequestFullscreen).call(document.documentElement);
      }else{
        (document.exitFullscreen||document.webkitExitFullscreen).call(document);
      }
    }catch(e){}
  }
  document.addEventListener("DOMContentLoaded", ()=>{
    const b=document.getElementById("fsBtn");
    if(b) b.onclick = toggleFullscreen;
  });
</script>

</body>
</html>